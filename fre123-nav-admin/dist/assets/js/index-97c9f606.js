/* empty css                  *//* empty css                   *//* empty css                     */import{h as g,P as y}from"./el-icon-37d8cfb4.js";import{I as p,M as k,a as Z,b as ee,s as C,e as ue}from"./notifications-e9df1fe4.js";import{f as U,_ as te,p as ae}from"./format-55200e38.js";import{c as le}from"./helper-48ea6d19.js";import{d as I,r as n,a as x,K as re,P as se,m as S,h as oe,i as c,k as o,w as s,j as m,S as f,J as M,n as q,R,U as ie,c as ne,g as pe}from"./index-1fdc2001.js";/* empty css                  */import"./plugin-vue_export-helper-b2bddca3.js";var de={title:"\u5E7F\u544A\u7BA1\u7406",propList:[{prop:"title",label:"\u5E7F\u544A\u6807\u9898",slotName:"title"},{prop:"description",label:"\u5E7F\u544A\u63CF\u8FF0"},{prop:"type",label:"\u5E7F\u544A\u7C7B\u578B",slotName:"surpriseType"},{prop:"img_url",label:"\u56FE\u7247\u5730\u5740",slotName:"imgUrl"},{prop:"position",label:"\u5E7F\u544A\u4F4D\u7F6E",slotName:"surprisePosition"},{prop:"web_path",label:"\u9875\u9762\u8DEF\u5F84",slotName:"webPath"},{prop:"start_ts",label:"\u5F00\u59CB\u65F6\u95F4",slotName:"createdTime"},{prop:"end_ts",label:"\u7ED3\u675F\u65F6\u95F4",slotName:"updatedTime"}]};const B={getSurpriseList:async(t={})=>{const{data:u}=await g.post(y+"/site_surprise/get",t);return u},addSurprise:async t=>{const{data:u}=await g.post(y+"/site_surprise/add",t);return u},editSurprise:async(t,u)=>{const{data:b}=await g.post(y+"/site_surprise/update",{ads_id:t,data:u});return b},delSurprise:async t=>await g.post(y+"/site_surprise/delete",{ads_id:t})},A={1:"\u7EAF\u56FE",2:"\u7EAF\u6587\u5B57"},O={1:"\u5C45\u4E2D\u5F39\u7A97",2:"\u53F3\u4E0B\u89D2",4:"\u5E95\u90E8\u8D34\u7247"},P={global:"\u6240\u6709\u9875\u9762","/":"\u9996\u9875","/search":"\u641C\u7D22\u7ED3\u679C\u9875","/res":"\u8BE6\u60C5\u9875"},ce=t=>{var u;return(u=A[t])!=null?u:"\u672A\u77E5"},Fe=t=>{var u;return(u=O[t])!=null?u:"\u672A\u77E5"},me=t=>{var u;return(u=P[t])!=null?u:t},ve=()=>{let t=[];return Object.keys(A).map(u=>{t.push({label:A[u],value:u})}),t},fe=()=>{let t=[];return Object.keys(O).map(u=>{t.push({label:O[u],value:u})}),t},L=()=>{let t=[];return Object.keys(P).map(u=>{t.push({label:P[u],value:u})}),t},be=[{type:p.select,field:"web_path",label:"\u6295\u653E\u9875\u9762: ",rules:[],otherOptions:{placeholder:"\u8BF7\u9009\u62E9\u6295\u653E\u9875\u9762",clearable:!0,multiple:!0,filterable:!0,remote:!0,"remote-method":"onSearch"},options:L()}],v="200px",Ee=[{type:p.input,field:"title",label:"\u5E7F\u544A\u6807\u9898: ",labelWidth:v,required:!0,rules:[],otherOptions:{placeholder:"\u8BF7\u8F93\u5165\u5E7F\u544A\u6807\u9898",clearable:!0}},{type:p.input,field:"url",label:"\u5E7F\u544A\u5730\u5740: ",required:!0,labelWidth:v,rules:[],otherOptions:{placeholder:"\u8BF7\u8F93\u5165\u5E7F\u544A\u5730\u5740",clearable:!0}},{type:p.select,field:"web_path",label:"\u6295\u653E\u9875\u9762: ",required:!0,rules:[],otherOptions:{placeholder:"\u8BF7\u9009\u62E9\u6295\u653E\u9875\u9762",clearable:!0},options:L()},{type:p.select,field:"type",label:"\u5E7F\u544A\u7C7B\u578B: ",required:!0,labelWidth:v,rules:[],options:ve(),otherOptions:{placeholder:"\u8BF7\u9009\u62E9\u5E7F\u544A\u7C7B\u578B",clearable:!0}},{field:"img_url",label:"",required:!1,labelWidth:v,rules:[],otherOptions:{placeholder:"\u8BF7\u8F93\u5165\u5E7F\u544A\u5C01\u9762\u5730\u5740",clearable:!0},slotName:"imgUrl"},{type:p.select,field:"position",label:"\u9875\u9762\u4F4D\u7F6E: ",required:!0,rules:[],otherOptions:{placeholder:"\u8BF7\u9009\u62E9\u9875\u9762\u4F4D\u7F6E",clearable:!0},options:fe()},{type:p.textArea,field:"description",label:"\u5E7F\u544A\u63CF\u8FF0: ",labelWidth:v,rules:[],otherOptions:{placeholder:"\u8BF7\u8F93\u5165\u5E7F\u544A\u63CF\u8FF0",clearable:!0}},{type:p.datePicker,field:"start_ts",label:"\u5F00\u59CB\u65F6\u95F4: ",required:!0,labelWidth:v,rules:[],otherOptions:{placeholder:"\u8BF7\u8F93\u5165\u5F00\u59CB\u65F6\u95F4",clearable:!0,editable:!0}},{type:p.datePicker,field:"end_ts",label:"\u7ED3\u675F\u65F6\u95F4: ",required:!0,labelWidth:v,rules:[],otherOptions:{placeholder:"\u8BF7\u8F93\u5165\u7ED3\u675F\u65F6\u95F4",clearable:!0,editable:!0}}],he=["href"],_e=["src"],ge=I({name:"metaTableTest"}),Ne=I({...ge,setup(t){const u=n(40),b=n(1),T=n(10),h=x({web_path:[]}),_=n([]),F=async()=>{const a=await B.getSurpriseList(h),e=a==null?void 0:a.rows;e==null||e.forEach(i=>{i.id=i.ads_id,i.start_ts=i.start_ts*1e3,i.end_ts=i.end_ts*1e3}),_.value=e,u.value=a==null?void 0:a.total},z=()=>{b.value=1,F()},W=async()=>{await F(),C("\u5237\u65B0\u6210\u529F")},D=n(),j=()=>{r.value={},d.value=!0,w.value="\u6DFB\u52A0\u5E7F\u544A",D.value="add"},E=n(0),$=async a=>{E.value=a.id,r.value=JSON.parse(JSON.stringify(_.value)).find(e=>e.id===a.id),d.value=!0,w.value="\u7F16\u8F91\u5E7F\u544A",D.value="edit"},J=async a=>{await B.delSurprise(a),C("\u5220\u9664\u6210\u529F"),F()},K=a=>{b.value=a,F()},G=a=>{T.value=a,F()},H=x({url:[{validator:(a,e,i)=>{if(le(e))i();else return i(new Error("\u8BF7\u8F93\u5165\u4EE5http://\u548Chttps://\u5F00\u5934\u7684\u6709\u6548\u5730\u5740"))},trigger:"blur"}]}),V=n(),d=n(!1),w=n(""),r=n({});re(()=>d.value,()=>{!d.value&&E.value!==0&&(E.value=0)});const Q=async()=>{E.value!==0?r.value=_.value.find(a=>a.ads_id===E.value):r.value={}},X=async()=>{var a;if(await V.value.validFun()){for(let e in r.value)typeof r.value[e]=="string"&&(r.value[e]=r.value[e].trim()),["start_ts","end_ts"].includes(e)&&(r.value,r.value[e]=ae(r.value[e]));if(r.value.start_ts>=r.value.end_ts)return ue("\u5F00\u59CB\u65F6\u95F4\u4E0D\u80FD\u5927\u4E8E\u7ED3\u675F\u65F6\u95F4");r.value,D.value=="add"?await B.addSurprise(r.value):await B.editSurprise((a=r.value)==null?void 0:a.ads_id,r.value),C("\u64CD\u4F5C\u6210\u529F"),d.value=!1,F()}};return F(),(a,e)=>{const i=ne,N=pe,Y=se;return S(),oe("div",null,[c(o(k),{modelValue:h,"onUpdate:modelValue":e[0]||(e[0]=l=>h=l),formItems:o(be),onOnSearch:z,onOnRefresh:W},null,8,["modelValue","formItems"]),c(te,null,{default:s(()=>[c(o(Z),{propList:o(de).propList,tableData:_.value,onAddData:j,onEditData:$,onDeleteData:J},{title:s(l=>[m("a",{href:l.row.url},f(l.row.title),9,he)]),surpriseType:s(l=>[m("div",null,f(o(ce)(l.row.type)),1)]),surprisePosition:s(l=>[m("div",null,f(o(Fe)(l.row.position)),1)]),webPath:s(l=>[m("div",null,f(o(me)(l.row.web_path)),1)]),imgUrl:s(l=>[m("img",{width:"50",src:l.row.img_url,alt:""},null,8,_e)]),createdTime:s(l=>[m("div",null,f(o(U)(l.row.start_ts/1e3)),1)]),updatedTime:s(l=>[m("div",null,f(o(U)(l.row.end_ts/1e3)),1)]),_:1},8,["propList","tableData"])]),_:1}),c(o(ee),{totalCount:u.value,currentPage:b.value,pageSize:T.value,onCurrentChange:K,onSizeChange:G},null,8,["totalCount","currentPage","pageSize"]),d.value?(S(),M(ie,{key:0,to:"body"},[c(Y,{modelValue:d.value,"onUpdate:modelValue":e[5]||(e[5]=l=>d.value=l),title:w.value,width:"500px"},{footer:s(()=>[c(N,{onClick:e[3]||(e[3]=l=>Q()),link:""},{default:s(()=>[q("\u91CD\u7F6E")]),_:1}),c(N,{type:"primary",onClick:e[4]||(e[4]=l=>X())},{default:s(()=>[q("\u786E\u8BA4")]),_:1})]),default:s(()=>[c(o(k),{modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=l=>r.value=l),rules:H,ref_key:"editFormRef",ref:V,formItems:o(Ee),inline:!1,showRefresh:!1,showSearch:!1,labelWidth:"120px",labelPosition:"right"},{imgUrl:s(()=>[r.value.type==1||r.value.type==3?(S(),M(i,{key:0,type:"text",modelValue:r.value.img_url,"onUpdate:modelValue":e[1]||(e[1]=l=>r.value.img_url=l),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u56FE\u7247\u5730\u5740"},null,8,["modelValue"])):R("",!0)]),_:1},8,["modelValue","rules","formItems"])]),_:1},8,["modelValue","title"])])):R("",!0)])}}});export{Ne as default};

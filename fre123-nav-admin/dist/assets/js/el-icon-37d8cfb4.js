var p=Object.defineProperty;var B=(r,u,e)=>u in r?p(r,u,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[u]=e;var i=(r,u,e)=>(B(r,typeof u!="symbol"?u+"":u,e),e);import{l as t,G as o,v as F,x as D,y as E,A}from"./index-1fdc2001.js";const b="/metaso/api/v1";var c=(r=>(r[r.SUCCESS=200]="SUCCESS",r[r.ERROR=500]="ERROR",r[r.OVERDUE=902]="OVERDUE",r[r.TIMEOUT=1e4]="TIMEOUT",r.TYPE="success",r[r.NOT_AUTH=401]="NOT_AUTH",r[r.TOKEN_ERROR=422]="TOKEN_ERROR",r))(c||{});const T=r=>{switch(r){case 400:t.error("\u8BF7\u6C42\u5931\u8D25\uFF01\u8BF7\u60A8\u7A0D\u540E\u91CD\u8BD5");break;case 401:t.error("\u767B\u5F55\u5931\u6548\uFF01\u8BF7\u60A8\u91CD\u65B0\u767B\u5F55"),o().setToken(""),o().setAppUserName(""),F.replace({path:"/login"});break;case 403:t.error("\u5F53\u524D\u8D26\u53F7\u65E0\u6743\u9650\u8BBF\u95EE\uFF01"),o().setToken(""),o().setAppUserName(""),F.replace({path:"/login"});break;case 404:t.error("\u4F60\u6240\u8BBF\u95EE\u7684\u8D44\u6E90\u4E0D\u5B58\u5728\uFF01");break;case 405:t.error("\u8BF7\u6C42\u65B9\u5F0F\u9519\u8BEF\uFF01\u8BF7\u60A8\u7A0D\u540E\u91CD\u8BD5");break;case 408:t.error("\u8BF7\u6C42\u8D85\u65F6\uFF01\u8BF7\u60A8\u7A0D\u540E\u91CD\u8BD5");break;case 500:t.error("\u670D\u52A1\u5F02\u5E38\uFF01");break;case 502:t.error("\u7F51\u5173\u9519\u8BEF\uFF01");break;case 422:t.error("TOKEN \u5F02\u5E38\uFF0C\u8BF7\u91CD\u65B0\u767B\u9646\uFF01"),o().setToken(""),F.replace({path:"/login"});break;case 503:t.error("\u670D\u52A1\u4E0D\u53EF\u7528\uFF01");break;case 504:t.error("\u7F51\u5173\u8D85\u65F6\uFF01");break;default:t.error("\u8BF7\u6C42\u5931\u8D25\uFF01")}},h=new A,C={}.VITE_API_URL,O={baseURL:C,timeout:1e3*10,withCredentials:!0};class U{constructor(u){i(this,"service");this.service=D.create(u),this.service.interceptors.request.use(e=>{var s,a;return e.headers={Authorization:`Bearer ${E()}`,"APP-USERNAME":o().appUserName,Method:(a=(s=e.method)==null?void 0:s.toUpperCase())!=null?a:"POST","Content-Type":"application/json",...e.headers},e},e=>Promise.reject(e)),this.service.interceptors.response.use(e=>{const s=o(),{data:a,config:n}=e;return h.removePending(n),a.status==c.OVERDUE||a.status==c.NOT_AUTH?(t.error(a.info),F.replace({path:"/login"}),s.setToken(""),s.setAppUserName(""),Promise.reject(a)):a.status?(t.error(a.info),Promise.reject(a)):a},async e=>{const{response:s}=e;return e.message.indexOf("timeout")!==-1&&t.error("\u8BF7\u6C42\u8D85\u65F6\uFF01\u8BF7\u60A8\u7A0D\u540E\u91CD\u8BD5"),s&&T(s.status),window.navigator.onLine||F.replace({path:"/500"}),Promise.reject(e)})}get(u,e,s={}){return this.service.get(u,{params:e,...s})}post(u,e,s={}){return this.service.post(u,e,s)}put(u,e,s={}){return this.service.put(u,e,s)}delete(u,e,s={}){return this.service.delete(u,{params:e,...s})}}var d=new U(O);export{b as P,d as h};
